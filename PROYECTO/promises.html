<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="ES6: var vs let vs const">
  <title>Proyecto - Edison Chung - Fabrizio Ramírez</title>

  <!-- Pure.css -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/pure-min.css">
  <link rel="stylesheet" href="side-menu.css">

</head>

<body>

  <div id="layout">
    <a href="#menu" id="menuLink" class="menu-link">
      <span></span>
    </a>

    <div id="menu">
      <div class="pure-menu">
        <a class="pure-menu-heading" href="index.html">ES6</a>

        <ul class="pure-menu-list">
          <li class="pure-menu-item"><a href="varletconst.html" class="pure-menu-link">var vs let / const</a></li>
          <li class="pure-menu-item"><a href="blocks.html" class="pure-menu-link">IIFEs ahora Blocks</a></li>
          <li class="pure-menu-item"><a href="arrow.html" class="pure-menu-link">Arrow Functions</a></li>
          <li class="pure-menu-item"><a href="strings.html" class="pure-menu-link">Strings .includes() .repeat()</a></li>
          <li class="pure-menu-item"><a href="literals.html" class="pure-menu-link">Template literals</a></li>
          <li class="pure-menu-item"><a href="arrays.html" class="pure-menu-link">Destructuring arrays</a></li>
          <li class="pure-menu-item"><a href="objects.html" class="pure-menu-link">Destructuring objects</a></li>
          <li class="pure-menu-item"><a href="modules.html" class="pure-menu-link">Modules export and import</a></li>
          <li class="pure-menu-item"><a href="parameters.html" class="pure-menu-link">Parameters</a></li>
          <li class="pure-menu-item"><a href="spread.html" class="pure-menu-link">Spread Operator</a></li>
          <li class="pure-menu-item"><a href="classes.html" class="pure-menu-link">Classes</a></li>
          <li class="pure-menu-item pure-menu-selected"><a href="promises.html" class="pure-menu-link">Promises</a></li>
          <li class="pure-menu-item"><a href="getset.html" class="pure-menu-link">Getter and Setter</a></li>
        </ul>
      </div>
    </div>

    <div id="main">
      <div class="header">
        <h1>ECMAScript 2015 (ES6)</h1>
        <h2>Edison Chung - Fabrizio Ramírez - Pure.css</h2>
      </div>

      <div class="content">
        <h2 class="content-subhead">Promises</h2>
        <p>Promises permiten convertir el código horizontal (callback hell):</p>
        <pre>
          <code>
            func1(function (value1) {
              func2(value1, function (value2) {
                func3(value2, function (value3) {
                  func4(value3, function (value4) {
                    func5(value4, function (value5) {
                      // Do something with value 5
                    });
                  });
                });
              });
            });
          </code>
        </pre>
        <p>A código vertical:</p>
        <pre>
          <code>
            func1(value1)
              .then(func2)
              .then(func3)
              .then(func4)
              .then(func5, value5 => {
                // Do something with value 5
              });
          </code>
        </pre>
        <p>Antes de ES6, se usaba bluebird o Q. Ahora se tiene Promises nativamente:</p>
        <pre>
          <code>
            new Promise((resolve, reject) =>
              reject(new Error('Failed to fulfill Promise')))
                .catch(reason => console.log(reason));
          </code>
        </pre>
        <p>Donde existen dos handlers, <b>resolve</b> (una función llamada cuando la Promise se cumple) y <b>reject</b> (una función llamada cuando la Promise se rechaza).</p>
        <h2 class="content-subhead">Beneficios de Promises</h2>
        <p>El manejo de errores utilzando callbacks anidados puede volverse caótico. Utilzando Promises, se tiene un camino claro para elevar los errores y manejarlos apropiadamente. Además, el valor de una Promise después de ser resuelta/rechazada es inmutable
          - nunca va a cambiar.</p>
        <p>Un ejemplo práctico del uso de Promises:</p>
        <pre>
          <code>
            var request = require('request');
            return new Promise((resolve, reject) => {
              request.get(url, (error, response, body) => {
                if (body) {
                  resolve(JSON.parse(body));
                } else {
                  resolve({});
                }
              });
            });
          </code>
        </pre>
        <p>También se pueden paralelizar Promises para manejar un array de operaciones asíncronas utilizando <code>Promise.all()</code>:</p>
        <pre>
          <code>
            let urls = [
              '/api/commits',
              '/api/issues/opened',
              '/api/issues/assigned',
              '/api/issues/completed',
              '/api/issues/comments',
              '/api/pullrequests'
            ];
            let promises = urls.map((url) => {
              return new Promise((resolve, reject) => {
                $.ajax({ url: url })
                  .done((data) => {
                    resolve(data);
                  });
              });
            });
            Promise.all(promises)
              .then((results) => {
                // Do something with results of all our promises
            });
          </code>
        </pre>

        <br>
        <a class="pure-button pure-button-primary" href="getset.html">Siguiente</a>

      </div>
    </div>
  </div>

  <script src="ui.js"></script>

</body>

</html>